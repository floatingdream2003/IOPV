(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9665:function(e,t,s){Promise.resolve().then(s.bind(s,2449))},2449:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var a=s(7437),r=s(2265),n=s(5348),l=s(5010);function i(){let[e,t]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{localStorage.getItem("hasClosedAnnouncement_v1")||t(!0)},[]),(0,a.jsx)(n.M,{children:e&&(0,a.jsx)(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{position:"fixed",inset:0,zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(4px)",padding:"20px"},children:(0,a.jsxs)(l.E.div,{initial:{scale:.95,opacity:0,y:10},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:10},className:"glass",style:{width:"100%",maxWidth:"400px",padding:"24px",position:"relative",display:"flex",flexDirection:"column",gap:"16px"},children:[(0,a.jsxs)("div",{className:"title",style:{display:"flex",alignItems:"center",gap:"12px",fontWeight:700,fontSize:"18px",color:"var(--accent)"},children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),(0,a.jsx)("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),(0,a.jsx)("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),(0,a.jsx)("span",{children:"公告"})]}),(0,a.jsx)("div",{style:{color:"var(--text)",lineHeight:"1.6",fontSize:"15px"},children:"已解决并发刷新导致数据错乱问题，遇到有问题的数据可以删除后重新添加，抱歉给您带来的不便。"}),(0,a.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"8px"},children:(0,a.jsx)("button",{className:"button",onClick:()=>{localStorage.setItem("hasClosedAnnouncement_v1","true"),t(!1)},style:{width:"100%",justifyContent:"center",display:"flex",alignItems:"center"},children:"我知道了"})})]})})})}function o(e){return(0,a.jsx)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:(0,a.jsx)("path",{d:"M12 5v14M5 12h14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}function c(e){return(0,a.jsxs)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:[(0,a.jsx)("path",{d:"M3 6h18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,a.jsx)("path",{d:"M8 6l1-2h6l1 2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,a.jsx)("path",{d:"M6 6l1 13a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2l1-13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,a.jsx)("path",{d:"M10 11v6M14 11v6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}function d(e){return(0,a.jsxs)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor",strokeWidth:"2"}),(0,a.jsx)("path",{d:"M19.4 15a7.97 7.97 0 0 0 .1-2l2-1.5-2-3.5-2.3.5a8.02 8.02 0 0 0-1.7-1l-.4-2.3h-4l-.4 2.3a8.02 8.02 0 0 0-1.7 1l-2.3-.5-2 3.5 2 1.5a7.97 7.97 0 0 0 .1 2l-2 1.5 2 3.5 2.3-.5a8.02 8.02 0 0 0 1.7 1l.4 2.3h4l.4-2.3a8.02 8.02 0 0 0 1.7-1l2.3.5 2-3.5-2-1.5z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}function h(e){return(0,a.jsxs)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:[(0,a.jsx)("path",{d:"M4 12a8 8 0 0 1 12.5-6.9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,a.jsx)("path",{d:"M16 5h3v3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,a.jsx)("path",{d:"M20 12a8 8 0 0 1-12.5 6.9",stroke:"currentColor",strokeWidth:"2"}),(0,a.jsx)("path",{d:"M8 19H5v-3",stroke:"currentColor",strokeWidth:"2"})]})}function u(e){return(0,a.jsx)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:(0,a.jsx)("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function m(e){return(0,a.jsx)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:(0,a.jsx)("path",{d:"M3 7h18M6 12h12M9 17h6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}function g(e){return(0,a.jsxs)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:[(0,a.jsx)("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1",stroke:"currentColor",strokeWidth:"2"}),(0,a.jsx)("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1",stroke:"currentColor",strokeWidth:"2"}),(0,a.jsx)("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1",stroke:"currentColor",strokeWidth:"2"}),(0,a.jsx)("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1",stroke:"currentColor",strokeWidth:"2"})]})}function x(e){return(0,a.jsx)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:(0,a.jsx)("path",{d:"M8 6h13M8 12h13M8 18h13M3 6h.01M3 12h.01M3 18h.01",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function p(e){return(0,a.jsx)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",children:(0,a.jsx)("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function v(e){let{label:t,value:s,delta:r}=e;return(0,a.jsxs)("div",{className:"stat",children:[(0,a.jsx)("span",{className:"label",children:t}),(0,a.jsx)("span",{className:"value ".concat(r>0?"up":r<0?"down":""),children:s})]})}function j(){let[e,t]=(0,r.useState)([]),[s,j]=(0,r.useState)(""),[y,f]=(0,r.useState)(!1),[b,w]=(0,r.useState)(""),N=(0,r.useRef)(null),k=(0,r.useRef)(!1),[S,z]=(0,r.useState)(3e4),[C,I]=(0,r.useState)(!1),[W,M]=(0,r.useState)(30),[O,E]=(0,r.useState)(!1),[A,B]=(0,r.useState)(new Set),[L,F]=(0,r.useState)(new Set),[J,G]=(0,r.useState)("all"),[_,P]=(0,r.useState)("default"),[D,T]=(0,r.useState)("card"),[R,H]=(0,r.useState)("holding"),[q,K]=(0,r.useState)({}),[V,$]=(0,r.useState)(!1),[Q,U]=(0,r.useState)(""),[X,Y]=(0,r.useState)(""),[Z,ee]=(0,r.useState)(new Set),et=e=>{ee(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),localStorage.setItem("holdingFunds",JSON.stringify(Array.from(s))),s})},es=()=>{Q.trim()&&(K(e=>({...e,[Q.trim()]:new Set})),localStorage.setItem("customGroups",JSON.stringify({...q,[Q.trim()]:[]})),U(""),$(!1))},ea=(e,t)=>{K(s=>{let a={...s};a[t]||(a[t]=new Set),a[t].add(e);let r={};return Object.keys(a).forEach(e=>{r[e]=Array.from(a[e])}),localStorage.setItem("customGroups",JSON.stringify(r)),a})},er=e=>{B(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),localStorage.setItem("collapsedCodes",JSON.stringify(Array.from(s))),s})},en=e=>{let t=new Set;return e.filter(e=>{let s=null==e?void 0:e.code;return!(!s||t.has(s))&&(t.add(s),!0)})};(0,r.useEffect)(()=>{try{let e=JSON.parse(localStorage.getItem("funds")||"[]");if(Array.isArray(e)&&e.length){let s=en(e);t(s),localStorage.setItem("funds",JSON.stringify(s));let a=Array.from(new Set(s.map(e=>e.code)));a.length&&eo(a)}let s=parseInt(localStorage.getItem("refreshMs")||"30000",10);Number.isFinite(s)&&s>=5e3&&(z(s),M(Math.round(s/1e3)));let a=JSON.parse(localStorage.getItem("collapsedCodes")||"[]");Array.isArray(a)&&B(new Set(a));let r=JSON.parse(localStorage.getItem("favorites")||"[]");Array.isArray(r)&&F(new Set(r));let n=JSON.parse(localStorage.getItem("holdingFunds")||"[]");Array.isArray(n)&&ee(new Set(n));let l=JSON.parse(localStorage.getItem("customGroups")||"{}");if("object"==typeof l){let e={};Object.keys(l).forEach(t=>{e[t]=new Set(l[t]||[])}),K(e)}let i=localStorage.getItem("viewMode");("card"===i||"list"===i)&&T(i)}catch(e){}},[]),(0,r.useEffect)(()=>(N.current&&clearInterval(N.current),N.current=setInterval(()=>{let t=Array.from(new Set(e.map(e=>e.code)));t.length&&eo(t)},S),()=>{N.current&&clearInterval(N.current)}),[e,S]);let el=e=>new Promise((t,s)=>{let a=document.createElement("script");a.src=e,a.async=!0,a.onload=()=>{document.body.removeChild(a),t()},a.onerror=()=>{document.body.removeChild(a),s(Error("数据加载失败"))},document.body.appendChild(a)}),ei=async e=>new Promise(async(t,s)=>{let a=e=>e.startsWith("6")||e.startsWith("9")?"sh":e.startsWith("0")||e.startsWith("3")?"sz":e.startsWith("4")||e.startsWith("8")?"bj":"sz",r="https://fundgz.1234567.com.cn/js/".concat(e,".js?rt=").concat(Date.now());"jsonpgz_".concat(e,"_").concat(Math.random().toString(36).slice(2,7));let n=document.createElement("script");n.src=r;let l=window.jsonpgz;window.jsonpgz=r=>{if(window.jsonpgz=l,!r||"object"!=typeof r){s(Error("未获取到基金估值数据"));return}let n=Number(r.gszzl),i={code:r.fundcode,name:r.name,dwjz:r.dwjz,gsz:r.gsz,gztime:r.gztime,gszzl:Number.isFinite(n)?n:r.gszzl};el("https://fundf10.eastmoney.com/FundArchivesDatas.aspx?type=jjcc&code=".concat(e,"&topline=10&year=&month=&rt=").concat(Date.now())).then(async()=>{var e;let s=[];for(let t of((null===(e=window.apidata)||void 0===e?void 0:e.content)||"").match(/<tr[\s\S]*?<\/tr>/gi)||[]){let e=(t.match(/<td[\s\S]*?>([\s\S]*?)<\/td>/gi)||[]).map(e=>e.replace(/<[^>]*>/g,"").trim()),a=e.findIndex(e=>/^\d{6}$/.test(e)),r=e.findIndex(e=>/\d+(?:\.\d+)?\s*%/.test(e));a>=0&&r>=0&&s.push({code:e[a],name:e[a+1]||"",weight:e[r],change:null})}if((s=s.slice(0,10)).length)try{let e=s.map(e=>"s_".concat(a(e.code)).concat(e.code)).join(","),t="https://qt.gtimg.cn/q=".concat(e);await new Promise(e=>{let r=document.createElement("script");r.src=t,r.onload=()=>{s.forEach(e=>{let t="v_s_".concat(a(e.code)).concat(e.code),s=window[t];if(s){let t=s.split("~");t.length>5&&(e.change=parseFloat(t[5]))}}),document.body.contains(r)&&document.body.removeChild(r),e()},r.onerror=()=>{document.body.contains(r)&&document.body.removeChild(r),e()},document.body.appendChild(r)})}catch(e){console.error("获取股票涨跌幅失败",e)}t({...i,holdings:s})}).catch(()=>t({...i,holdings:[]}))},n.onerror=()=>{window.jsonpgz=l,document.body.contains(n)&&document.body.removeChild(n),s(Error("基金数据加载失败"))},document.body.appendChild(n),setTimeout(()=>{document.body.contains(n)&&document.body.removeChild(n)},5e3)}),eo=async s=>{if(k.current)return;k.current=!0,E(!0);let a=Array.from(new Set(s));try{let s=[];for(let t of a)try{let e=await ei(t);s.push(e)}catch(r){console.error("刷新基金 ".concat(t," 失败"),r);let a=e.find(e=>e.code===t);a&&s.push(a)}let r=en(s);r.length&&(t(r),localStorage.setItem("funds",JSON.stringify(r)))}catch(e){console.error(e)}finally{k.current=!1,E(!1)}},ec=async a=>{a.preventDefault(),w("");let r=s.trim();if(!r){w("请输入产品代码");return}let n=e.find(e=>e.code===r);if("custom"===R&&X&&n){ea(r,X),j("");return}if(n){w("该产品已存在");return}f(!0);try{let s=[await ei(r),...e];t(s),localStorage.setItem("funds",JSON.stringify(s)),"holding"===R?ee(e=>{let t=new Set(e);return t.add(r),localStorage.setItem("holdingFunds",JSON.stringify(Array.from(t))),t}):"custom"===R&&X&&q[X]&&ea(r,X),j("")}catch(e){w(e.message||"操作失败")}finally{f(!1)}},ed=s=>{let a=e.filter(e=>e.code!==s);t(a),localStorage.setItem("funds",JSON.stringify(a)),B(e=>{if(!e.has(s))return e;let t=new Set(e);return t.delete(s),localStorage.setItem("collapsedCodes",JSON.stringify(Array.from(t))),t}),F(e=>{if(!e.has(s))return e;let t=new Set(e);return t.delete(s),localStorage.setItem("favorites",JSON.stringify(Array.from(t))),0===t.size&&"fav"===J&&G("all"),t}),ee(e=>{if(!e.has(s))return e;let t=new Set(e);return t.delete(s),localStorage.setItem("holdingFunds",JSON.stringify(Array.from(t))),t}),K(e=>{let t={...e},a=!1;if(Object.keys(t).forEach(e=>{t[e].has(s)&&(t[e].delete(s),a=!0,0===t[e].size&&delete t[e])}),a){let e={};Object.keys(t).forEach(s=>{e[s]=Array.from(t[s])}),localStorage.setItem("customGroups",JSON.stringify(e))}return t})},eh=async()=>{if(k.current)return;let t=Array.from(new Set(e.map(e=>e.code)));t.length&&await eo(t)};return(0,r.useEffect)(()=>{let e=e=>{"Escape"===e.key&&C&&I(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[C]),(0,a.jsxs)("div",{className:"container content",children:[(0,a.jsx)(i,{}),(0,a.jsxs)("div",{className:"navbar glass",children:[O&&(0,a.jsx)("div",{className:"loading-bar"}),(0,a.jsxs)("div",{className:"brand",children:[(0,a.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"var(--accent)",strokeWidth:"2"}),(0,a.jsx)("path",{d:"M5 14c2-4 7-6 14-5",stroke:"var(--primary)",strokeWidth:"2"})]}),(0,a.jsx)("span",{children:"基金实时估值"})]}),(0,a.jsxs)("div",{className:"actions",children:[(0,a.jsxs)("div",{className:"badge",title:"当前刷新频率",children:[(0,a.jsx)("span",{children:"刷新"}),(0,a.jsxs)("strong",{children:[Math.round(S/1e3),"秒"]})]}),(0,a.jsx)("button",{className:"icon-button","aria-label":"立即刷新",onClick:eh,disabled:O||0===e.length,"aria-busy":O,title:"立即刷新",children:(0,a.jsx)(h,{className:O?"spin":"",width:"18",height:"18"})}),(0,a.jsx)("button",{className:"icon-button","aria-label":"打开设置",onClick:()=>I(!0),title:"设置",children:(0,a.jsx)(d,{width:"18",height:"18"})})]})]}),(0,a.jsxs)("div",{className:"grid",children:[(0,a.jsxs)("div",{className:"col-12 glass card add-fund-section",role:"region","aria-label":"添加基金",children:[(0,a.jsxs)("div",{className:"title",style:{marginBottom:12},children:[(0,a.jsx)(o,{width:"20",height:"20"}),(0,a.jsx)("span",{children:"添加基金"}),(0,a.jsx)("span",{className:"muted",children:"请输入基金代码（例：004433）"})]}),(0,a.jsxs)("div",{style:{marginBottom:16},children:[(0,a.jsx)("div",{className:"muted",style:{marginBottom:8,fontSize:"0.8rem"},children:"添加类型"}),(0,a.jsxs)("div",{className:"chips",style:{marginBottom:12},children:[(0,a.jsx)("button",{type:"button",className:"chip ".concat("holding"===R?"active":""),onClick:()=>H("holding"),children:"持有基金"}),(0,a.jsxs)("button",{type:"button",className:"chip ".concat("custom"===R?"active":""),onClick:()=>H("custom"),children:[(0,a.jsx)(p,{width:"14",height:"14"}),"自建分组"]})]}),"custom"===R&&(0,a.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[(0,a.jsxs)("select",{className:"input",value:X,onChange:e=>Y(e.target.value),style:{flex:1,minWidth:"120px",background:"rgba(255,255,255,0.05)",color:"var(--text)",border:"2px solid var(--border)"},children:[(0,a.jsx)("option",{value:"",style:{background:"var(--card)",color:"var(--text)"},children:"选择分组"}),Object.keys(q).map(e=>(0,a.jsx)("option",{value:e,style:{background:"var(--card)",color:"var(--text)"},children:e},e))]}),(0,a.jsx)("button",{type:"button",className:"button",onClick:()=>$(!0),style:{whiteSpace:"nowrap"},children:"新建分组"})]})]}),(0,a.jsxs)("form",{className:"form",onSubmit:ec,children:[(0,a.jsx)("input",{className:"input",placeholder:"基金代码",value:s,onChange:e=>j(e.target.value),inputMode:"numeric"}),(0,a.jsx)("button",{className:"button",type:"submit",disabled:y||"custom"===R&&!X,children:y?"正在添加…":"添加"})]}),b&&(0,a.jsx)("div",{className:"muted",style:{marginTop:8,color:"var(--danger)"},children:b})]}),(0,a.jsxs)("div",{className:"col-12",children:[e.length>0&&(0,a.jsxs)("div",{className:"filter-bar",style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:12},children:[(0,a.jsxs)("div",{className:"tabs",children:[(0,a.jsxs)("button",{className:"tab ".concat("all"===J?"active":""),onClick:()=>G("all"),children:["全部基金 (",e.length,")"]}),Z.size>0&&(0,a.jsxs)("button",{className:"tab ".concat("holding"===J?"active":""),onClick:()=>G("holding"),children:["持有 (",Z.size,")"]}),Object.keys(q).map(e=>(0,a.jsxs)("button",{className:"tab ".concat(J==="group_".concat(e)?"active":""),onClick:()=>G("group_".concat(e)),children:[(0,a.jsx)(p,{width:"14",height:"14"}),e," (",q[e].size,")"]},e))]}),(0,a.jsxs)("div",{className:"sort-group",style:{display:"flex",alignItems:"center",gap:12},children:[(0,a.jsxs)("div",{className:"view-toggle",style:{display:"flex",background:"rgba(255,255,255,0.05)",borderRadius:"10px",padding:"2px"},children:[(0,a.jsx)("button",{className:"icon-button ".concat("card"===D?"active":""),onClick:()=>{T("card"),localStorage.setItem("viewMode","card")},style:{border:"none",width:"32px",height:"32px",background:"card"===D?"var(--primary)":"transparent",color:"card"===D?"#05263b":"var(--muted)"},title:"卡片视图",children:(0,a.jsx)(g,{width:"16",height:"16"})}),(0,a.jsx)("button",{className:"icon-button ".concat("list"===D?"active":""),onClick:()=>{T("list"),localStorage.setItem("viewMode","list")},style:{border:"none",width:"32px",height:"32px",background:"list"===D?"var(--primary)":"transparent",color:"list"===D?"#05263b":"var(--muted)"},title:"表格视图",children:(0,a.jsx)(x,{width:"16",height:"16"})})]}),(0,a.jsx)("div",{className:"divider",style:{width:"1px",height:"20px",background:"var(--border)"}}),(0,a.jsxs)("div",{className:"sort-items",style:{display:"flex",alignItems:"center",gap:8},children:[(0,a.jsxs)("span",{className:"muted",style:{fontSize:"12px",display:"flex",alignItems:"center",gap:4},children:[(0,a.jsx)(m,{width:"14",height:"14"}),"排序"]}),(0,a.jsx)("div",{className:"chips",children:[{id:"default",label:"智能排序"},{id:"yield",label:"收益排序"},{id:"name",label:"名称排序"},{id:"code",label:"代码排序"}].map(e=>(0,a.jsx)("button",{className:"chip ".concat(_===e.id?"active":""),onClick:()=>P(e.id),style:{height:"28px",fontSize:"12px",padding:"0 10px"},children:e.label},e.id))})]})]})]}),0===e.length?(0,a.jsx)("div",{className:"glass card empty",children:"暂无基金数据"}):(0,a.jsx)(n.M,{mode:"wait",children:(0,a.jsx)(l.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"card"===D?"grid":"table-container glass",children:(0,a.jsx)("div",{className:"card"===D?"grid col-12":"",style:"card"===D?{gridColumn:"span 12",gap:16}:{},children:(0,a.jsx)(n.M,{mode:"popLayout",children:e.filter(e=>{if("all"===J)return!0;if("holding"===J)return Z.has(e.code);if(J.startsWith("group_")){var t;return(null===(t=q[J.replace("group_","")])||void 0===t?void 0:t.has(e.code))||!1}return!0}).sort((e,t)=>{if("yield"===_){let s="number"==typeof e.estGszzl?e.estGszzl:Number(e.gszzl)||0;return("number"==typeof t.estGszzl?t.estGszzl:Number(t.gszzl)||0)-s}return"name"===_?e.name.localeCompare(t.name,"zh-CN"):"code"===_?e.code.localeCompare(t.code):0}).map(e=>{var t,s,r,i,o;return(0,a.jsx)(l.E.div,{layout:"position",className:"card"===D?"col-12":"table-row-wrapper",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},children:(0,a.jsx)("div",{className:"card"===D?"glass card":"table-row",children:"list"===D?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"table-cell name-cell",children:[(0,a.jsx)("div",{style:{display:"flex",alignItems:"center",gap:4},children:(0,a.jsx)("button",{className:"icon-button ".concat(Z.has(e.code)?"active":""),onClick:t=>{t.stopPropagation(),et(e.code)},title:Z.has(e.code)?"取消持有":"标记持有",style:{width:"auto",minWidth:"50px",height:"28px",fontSize:"12px",fontWeight:"600",padding:"0 8px",background:Z.has(e.code)?"var(--danger)":"rgba(255,255,255,0.05)",color:Z.has(e.code)?"white":"var(--muted)"},children:"持有"})}),(0,a.jsxs)("div",{className:"title-text",children:[(0,a.jsx)("span",{className:"name-text",children:e.name}),(0,a.jsxs)("span",{className:"muted code-text",children:["#",e.code]})]})]}),(0,a.jsx)("div",{className:"table-cell text-right value-cell",children:(0,a.jsx)("span",{style:{fontWeight:700},children:e.estPricedCoverage>.05?e.estGsz.toFixed(4):null!==(t=e.gsz)&&void 0!==t?t:"—"})}),(0,a.jsx)("div",{className:"table-cell text-right change-cell",children:(0,a.jsx)("span",{className:e.estPricedCoverage>.05?e.estGszzl>0?"up":e.estGszzl<0?"down":"":Number(e.gszzl)>0?"up":0>Number(e.gszzl)?"down":"",style:{fontWeight:700},children:e.estPricedCoverage>.05?"".concat(e.estGszzl>0?"+":"").concat(e.estGszzl.toFixed(2),"%"):"number"==typeof e.gszzl?"".concat(e.gszzl>0?"+":"").concat(e.gszzl.toFixed(2),"%"):null!==(s=e.gszzl)&&void 0!==s?s:"—"})}),(0,a.jsx)("div",{className:"table-cell text-right time-cell",children:(0,a.jsx)("span",{className:"muted",style:{fontSize:"12px"},children:e.gztime||e.time||"-"})}),(0,a.jsx)("div",{className:"table-cell text-center action-cell",children:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4},children:[L.has(e.code)&&Object.keys(q).length>0&&(0,a.jsxs)("select",{className:"input",value:"",onChange:t=>{t.target.value&&(ea(e.code,t.target.value),t.target.value="")},style:{width:"auto",minWidth:"80px",height:"28px",fontSize:"11px",padding:"0 6px",background:"rgba(255,255,255,0.05)",color:"var(--text)",border:"1px solid var(--border)"},children:[(0,a.jsx)("option",{value:"",style:{background:"var(--card)",color:"var(--text)"},children:"+分组"}),Object.keys(q).map(e=>(0,a.jsx)("option",{value:e,style:{background:"var(--card)",color:"var(--text)"},children:e},e))]}),(0,a.jsx)("button",{className:"icon-button danger",onClick:()=>ed(e.code),title:"删除",style:{width:"28px",height:"28px"},children:(0,a.jsx)(c,{width:"14",height:"14"})})]})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"row",style:{marginBottom:10},children:[(0,a.jsxs)("div",{className:"title",children:[(0,a.jsx)("div",{style:{display:"flex",alignItems:"center",gap:4},children:(0,a.jsx)("button",{className:"icon-button ".concat(Z.has(e.code)?"active":""),onClick:t=>{t.stopPropagation(),et(e.code)},title:Z.has(e.code)?"取消持有":"标记持有",style:{width:"auto",minWidth:"50px",height:"32px",fontSize:"12px",fontWeight:"600",padding:"0 10px",background:Z.has(e.code)?"var(--danger)":"rgba(255,255,255,0.05)",color:Z.has(e.code)?"white":"var(--muted)"},children:"持有"})}),(0,a.jsxs)("div",{className:"title-text",children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsxs)("span",{className:"muted",children:["#",e.code]})]})]}),(0,a.jsxs)("div",{className:"actions",children:[(0,a.jsxs)("div",{className:"badge-v",children:[(0,a.jsx)("span",{children:"估值时间"}),(0,a.jsx)("strong",{children:e.gztime||e.time||"-"})]}),L.has(e.code)&&Object.keys(q).length>0&&(0,a.jsxs)("select",{className:"input",value:"",onChange:t=>{t.target.value&&(ea(e.code,t.target.value),t.target.value="")},style:{width:"auto",minWidth:"100px",height:"32px",fontSize:"12px",padding:"0 8px",background:"rgba(255,255,255,0.05)",color:"var(--text)",border:"1px solid var(--border)"},children:[(0,a.jsx)("option",{value:"",style:{background:"var(--card)",color:"var(--text)"},children:"添加到分组"}),Object.keys(q).map(e=>(0,a.jsx)("option",{value:e,style:{background:"var(--card)",color:"var(--text)"},children:e},e))]}),(0,a.jsx)("button",{className:"icon-button danger",onClick:()=>ed(e.code),title:"删除",children:(0,a.jsx)(c,{width:"18",height:"18"})})]})]}),(0,a.jsxs)("div",{className:"row",style:{marginBottom:12},children:[(0,a.jsx)(v,{label:"单位净值",value:null!==(r=e.dwjz)&&void 0!==r?r:"—"}),(0,a.jsx)(v,{label:"估值净值",value:e.estPricedCoverage>.05?e.estGsz.toFixed(4):null!==(i=e.gsz)&&void 0!==i?i:"—"}),(0,a.jsx)(v,{label:"涨跌幅",value:e.estPricedCoverage>.05?"".concat(e.estGszzl>0?"+":"").concat(e.estGszzl.toFixed(2),"%"):"number"==typeof e.gszzl?"".concat(e.gszzl>0?"+":"").concat(e.gszzl.toFixed(2),"%"):null!==(o=e.gszzl)&&void 0!==o?o:"—",delta:e.estPricedCoverage>.05?e.estGszzl:Number(e.gszzl)||0})]}),e.estPricedCoverage>.05&&(0,a.jsxs)("div",{style:{fontSize:"10px",color:"var(--muted)",marginTop:-8,marginBottom:10,textAlign:"right"},children:["基于 ",Math.round(100*e.estPricedCoverage),"% 持仓估算"]}),(0,a.jsx)("div",{style:{marginBottom:8,cursor:"pointer",userSelect:"none"},className:"title",onClick:()=>er(e.code),children:(0,a.jsxs)("div",{className:"row",style:{width:"100%",flex:1},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,a.jsx)("span",{children:"前10重仓股票"}),(0,a.jsx)(u,{width:"16",height:"16",className:"muted",style:{transform:A.has(e.code)?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.2s ease"}})]}),(0,a.jsx)("span",{className:"muted",children:"涨跌幅 / 占比"})]})}),(0,a.jsx)(n.M,{children:!A.has(e.code)&&(0,a.jsx)(l.E.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},style:{overflow:"hidden"},children:Array.isArray(e.holdings)&&e.holdings.length?(0,a.jsx)("div",{className:"list",children:e.holdings.map((e,t)=>(0,a.jsxs)("div",{className:"item",children:[(0,a.jsx)("span",{className:"name",children:e.name}),(0,a.jsxs)("div",{className:"values",children:["number"==typeof e.change&&(0,a.jsxs)("span",{className:"badge ".concat(e.change>0?"up":e.change<0?"down":""),style:{marginRight:8},children:[e.change>0?"+":"",e.change.toFixed(2),"%"]}),(0,a.jsx)("span",{className:"weight",children:e.weight})]})]},t))}):(0,a.jsx)("div",{className:"muted",style:{padding:"8px 0"},children:"暂无重仓数据"})})})]})})},e.code)})})})},D)})]})]}),(0,a.jsxs)("div",{className:"footer",children:[(0,a.jsx)("p",{children:"数据来源于东方财富"}),(0,a.jsx)("p",{children:"仅供学习参考使用，不作为任何投资建议"})]}),V&&(0,a.jsx)("div",{className:"modal-overlay",role:"dialog","aria-modal":"true","aria-label":"新建分组",onClick:()=>$(!1),children:(0,a.jsxs)("div",{className:"glass card modal",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"title",style:{marginBottom:12},children:[(0,a.jsx)(p,{width:"20",height:"20"}),(0,a.jsx)("span",{children:"新建分组"}),(0,a.jsx)("span",{className:"muted",children:"创建自定义基金分组"})]}),(0,a.jsx)("div",{className:"form-group",style:{marginBottom:16},children:(0,a.jsx)("input",{className:"input",type:"text",value:Q,onChange:e=>U(e.target.value),placeholder:"输入分组名称",onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),es())}})}),(0,a.jsxs)("div",{className:"row",style:{justifyContent:"flex-end",marginTop:24,gap:8},children:[(0,a.jsx)("button",{className:"button",onClick:()=>$(!1),style:{background:"var(--muted)",color:"var(--bg)"},children:"取消"}),(0,a.jsx)("button",{className:"button",onClick:es,disabled:!Q.trim(),children:"创建分组"})]})]})}),C&&(0,a.jsx)("div",{className:"modal-overlay",role:"dialog","aria-modal":"true","aria-label":"设置",onClick:()=>I(!1),children:(0,a.jsxs)("div",{className:"glass card modal",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"title",style:{marginBottom:12},children:[(0,a.jsx)(d,{width:"20",height:"20"}),(0,a.jsx)("span",{children:"设置"}),(0,a.jsx)("span",{className:"muted",children:"配置刷新频率"})]}),(0,a.jsxs)("div",{className:"form-group",style:{marginBottom:16},children:[(0,a.jsx)("div",{className:"muted",style:{marginBottom:8,fontSize:"0.8rem"},children:"刷新频率"}),(0,a.jsx)("div",{className:"chips",style:{marginBottom:12},children:[10,30,60,120,300].map(e=>(0,a.jsxs)("button",{type:"button",className:"chip ".concat(W===e?"active":""),onClick:()=>M(e),"aria-pressed":W===e,children:[e," 秒"]},e))}),(0,a.jsx)("input",{className:"input",type:"number",min:"5",step:"5",value:W,onChange:e=>M(Number(e.target.value)),placeholder:"自定义秒数"})]}),(0,a.jsx)("div",{className:"row",style:{justifyContent:"flex-end",marginTop:24},children:(0,a.jsx)("button",{className:"button",onClick:e=>{var t;null==e||null===(t=e.preventDefault)||void 0===t||t.call(e);let s=1e3*Math.max(5,Number(W));z(s),localStorage.setItem("refreshMs",String(s)),I(!1)},children:"保存并关闭"})})]})})]})}}},function(e){e.O(0,[55,971,23,744],function(){return e(e.s=9665)}),_N_E=e.O()}]);